package service;


import bean.Constants;
import com.watch.ejb.Serialnumber;
import dao.SerialnumberDaoIml;

import java.util.HashMap;
import java.util.Map;
import java.util.List;
import com.opensymphony.xwork2.ActionSupport; 

/**
 * <p>Title: ejb title </p>
 * <p>Description: serialnumber Client Service 处理类</p>
 * @author yangqinxu 电话：137****5317
 * @version 1.0 时间  2015-9-5 10:58:53
 */

public class SerialnumberImpl extends ActionSupport {	
    private static final long serialVersionUID = 1L;
    private SerialnumberDaoIml  serialnumberDao;  
    private Map<String,Object> dataMap;
    private String message;     
    private Serialnumber serialnumber;
    private int page; 
    private int errcode;
    private String getIsReg;
    private String getIsOnline;
    
    public String getGetIsOnline() {
		return getIsOnline;
	}

	public void setGetIsOnline(String getIsOnline) {
		this.getIsOnline = getIsOnline;
	}

	public String getGetIsReg() {
		return getIsReg;
	}

	public void setGetIsReg(String getIsReg) {
		this.getIsReg = getIsReg;
	}

	public int getErrcode() {
		return errcode;
	}

	public void setErrcode(int errcode) {
		this.errcode = errcode;
	}
   
	public Serialnumber getSerialnumber() {
		return serialnumber;
	}

	public void setSerialnumber(Serialnumber rserialnumberInfo) {
		this.serialnumber =  rserialnumberInfo;
	}    
    
	public int getPage() {
		return page;
	}

	public void setPage(int page) {
		this.page = page;
	}		    
    
	public Map<String, Object> getDataMap() {
		return dataMap;
	}
    
    public String getMessage() {  
        return message;  
    }  
  
    public void setMessage(String message) {  
        this.message = message;  
    }
    
    public SerialnumberDaoIml getSerialnumberDao() {
		return serialnumberDao;
	}
    
	public void setSerialnumberDao (SerialnumberDaoIml rserialnumberDao) {		     
         this.serialnumberDao = rserialnumberDao;
	}
       
	public String AddSerialnumber() {	
    
    try {
 	  if(this.serialnumber.getFuniqueid() == null || this.serialnumber.getFuniqueid().length() <= 0){		
		  this.serialnumberDao.Add(this.serialnumber);	
		  this.message ="新增成功";
	  }
      else
	  {
          this.serialnumberDao.Update(this.serialnumber);	
		  this.message ="更新成功";
	  }     
      } catch (RuntimeException ex) {
		  this.message = ex.getMessage();
		  this.errcode = ex.hashCode();
	   }
	  
	  dataMap = new HashMap<String, Object>();
      dataMap.put("errcode", this.errcode);
	  dataMap.put("success", true);
	  dataMap.put("message", this.message);
	  
	  return SUCCESS;   			
	}
  
	private HashMap<String, String> GetQueryMap()
	{				
        HashMap<String, String> map = new HashMap<String, String>();
        
        if(getIsReg !=null && !getIsReg.equals(""))
        {
        	map.put("getIsReg", getIsReg);
        }
        if(getIsOnline !=null && !getIsOnline.equals(""))
        {
        	map.put("getIsOnline", getIsOnline);
        }   
        
        if(this.serialnumber.getSerialnumber()!=null && !this.serialnumber.getSerialnumber().equals(""))
        {
        	map.put("sn.serialnumber", this.serialnumber.getSerialnumber());
        }
        
        if(this.serialnumber.getFphonenum()!=null && !this.serialnumber.getFphonenum().equals(""))
        {
        	map.put("sn.fphonenum", this.serialnumber.getFphonenum());
        }
        
//		if(this.serialnumber!=null){
//        if(this.serialnumber.getFuniqueid()!=null && !this.serialnumber.getFuniqueid().equals("")){
//			map.put("funiqueid", this.serialnumber.getFuniqueid().toString());
//         }
//        if(this.serialnumber.getId()!=null && !this.serialnumber.getId().equals("")){
//			map.put("id", this.serialnumber.getId().toString());
//         }
//        if(this.serialnumber.getSerialnumber()!=null && !this.serialnumber.getSerialnumber().equals("")){
//			map.put("serialnumber", this.serialnumber.getSerialnumber().toString());
//         }
//        if(this.serialnumber.getStatus()!=null && !this.serialnumber.getStatus().equals("")){
//			map.put("status", this.serialnumber.getStatus().toString());
//         }
//        if(this.serialnumber.getEf()!=null && !this.serialnumber.getEf().equals("")){
//			map.put("ef", this.serialnumber.getEf().toString());
//         }
//        if(this.serialnumber.getSetgps()!=null && !this.serialnumber.getSetgps().equals("")){
//			map.put("setgps", this.serialnumber.getSetgps().toString());
//         }
//        if(this.serialnumber.getGpsstatus()!=null && !this.serialnumber.getGpsstatus().equals("")){
//			map.put("gpsstatus", this.serialnumber.getGpsstatus().toString());
//         }
//        if(this.serialnumber.getIsreg()!=null && !this.serialnumber.getIsreg().equals("")){
//			map.put("isreg", this.serialnumber.getIsreg().toString());
//         }
//        if(this.serialnumber.getLbs()!=null && !this.serialnumber.getLbs().equals("")){
//			map.put("lbs", this.serialnumber.getLbs().toString());
//         }
//        if(this.serialnumber.getListenstatus()!=null && !this.serialnumber.getListenstatus().equals("")){
//			map.put("listenstatus", this.serialnumber.getListenstatus().toString());
//         }
//        if(this.serialnumber.getOnline()!=null && !this.serialnumber.getOnline().equals("")){
//			map.put("online", this.serialnumber.getOnline().toString());
//         }
////        if(this.serialnumber.getOnlinetime()!=null && !this.serialnumber.getOnlinetime().equals("")){
////			map.put("onlinetime", this.serialnumber.getOnlinetime().toString());
////         }
//        if(this.serialnumber.getNickname()!=null && !this.serialnumber.getNickname().equals("")){
//			map.put("nickname", this.serialnumber.getNickname().toString());
//         }
//        if(this.serialnumber.getFqrcode()!=null && !this.serialnumber.getFqrcode().equals("")){
//			map.put("fqrcode", this.serialnumber.getFqrcode().toString());
//         }
//        if(this.serialnumber.getBirthday()!=null && !this.serialnumber.getBirthday().equals("")){
//			map.put("birthday", this.serialnumber.getBirthday().toString());
//         }
//        if(this.serialnumber.getFsex()!=null && !this.serialnumber.getFsex().equals("")){
//			map.put("fsex", this.serialnumber.getFsex().toString());
//         }
//        if(this.serialnumber.getFweight()!=null && !this.serialnumber.getFweight().equals("")){
//			map.put("fweight", this.serialnumber.getFweight().toString());
//         }
//        if(this.serialnumber.getFeight()!=null && !this.serialnumber.getFeight().equals("")){
//			map.put("feight", this.serialnumber.getFeight().toString());
//         }
//        if(this.serialnumber.getFgrade()!=null && !this.serialnumber.getFgrade().equals("")){
//			map.put("fgrade", this.serialnumber.getFgrade().toString());
//         }
//        if(this.serialnumber.getFclass()!=null && !this.serialnumber.getFclass().equals("")){
//			map.put("fclass", this.serialnumber.getFclass().toString());
//         }
//        if(this.serialnumber.getFschool()!=null && !this.serialnumber.getFschool().equals("")){
//			map.put("fschool", this.serialnumber.getFschool().toString());
//         }
//        if(this.serialnumber.getFcallname()!=null && !this.serialnumber.getFcallname().equals("")){
//			map.put("fcallname", this.serialnumber.getFcallname().toString());
//         }
//        if(this.serialnumber.getFlogcount()!=null && !this.serialnumber.getFlogcount().equals("")){
//			map.put("flogcount", this.serialnumber.getFlogcount().toString());
//         }
//        if(this.serialnumber.getFloglasttime()!=null && !this.serialnumber.getFloglasttime().equals("")){
//			map.put("floglasttime", this.serialnumber.getFloglasttime().toString());
//         }
//        if(this.serialnumber.getFloglastip()!=null && !this.serialnumber.getFloglastip().equals("")){
//			map.put("floglastip", this.serialnumber.getFloglastip().toString());
//         }
//        if(this.serialnumber.getFdatastatus()!=null && !this.serialnumber.getFdatastatus().equals("")){
//			map.put("fdatastatus", this.serialnumber.getFdatastatus().toString());
//         }
//        if(this.serialnumber.getFremark()!=null && !this.serialnumber.getFremark().equals("")){
//			map.put("fremark", this.serialnumber.getFremark().toString());
//         }
//        if(this.serialnumber.getFpicture()!=null && !this.serialnumber.getFpicture().equals("")){
//			map.put("fpicture", this.serialnumber.getFpicture().toString());
//         }
//        if(this.serialnumber.getFupdatetime()!=null && !this.serialnumber.getFupdatetime().equals("")){
//			map.put("fupdatetime", this.serialnumber.getFupdatetime().toString());
//         }
//        if(this.serialnumber.getFphonenum()!=null && !this.serialnumber.getFphonenum().equals("")){
//			map.put("fphonenum", this.serialnumber.getFphonenum().toString());
//         }
//        if(this.serialnumber.getFphonetime()!=null && !this.serialnumber.getFphonetime().equals("")){
//			map.put("fphonetime", this.serialnumber.getFphonetime().toString());
//         }
//        if(this.serialnumber.getFislostinfo()!=null && !this.serialnumber.getFislostinfo().equals("")){
//			map.put("fislostinfo", this.serialnumber.getFislostinfo().toString());
//         }
//        if(this.serialnumber.getFislosttime()!=null && !this.serialnumber.getFislosttime().equals("")){
//			map.put("fislosttime", this.serialnumber.getFislosttime().toString());
//         }
////        if(this.serialnumber.getFregtime()!=null && !this.serialnumber.getFregtime().equals("")){
////			map.put("fregtime", this.serialnumber.getFregtime().toString());
////         }
//        }
		
		return map;		
	}
    
	public String QuerySerialnumber() {
		dataMap = new HashMap<String, Object>();		
		int offset = this.getPage();		
		
		int pagesize = Constants.PAGE_SIZE;
		
		if (offset>0){
			offset = (offset-1) * pagesize;
		}
        
        HashMap<String, String> map = this.GetQueryMap();
        
        try {
		List<Serialnumber>  listSerialnumber= this.serialnumberDao.GetAll(offset, pagesize,map);
		
		int size = this.serialnumberDao.GetCountAll(map);
				
		dataMap.put("rows", listSerialnumber);
		dataMap.put("total", size);
        
 	    } catch (RuntimeException ex) {
			this.message = ex.getMessage();
			this.errcode = ex.hashCode();
		}  
        
        dataMap.put("errcode", this.errcode);
		dataMap.put("message", this.message);
        
		return SUCCESS;
	} 
    
 	public String FindSerialnumber() {		    
		 if(this.serialnumber.getFuniqueid() == null || this.serialnumber.getFuniqueid().length() <= 0){		
			 
		 }else
		 {
			 this.serialnumber = this.serialnumberDao.find(this.serialnumber.getFuniqueid());
			 
			 dataMap = new HashMap<String, Object>();		
			 dataMap.put("serialnumber", this.serialnumber);
			 
		 }
	     return SUCCESS;
	    
		} 
        
        
    public String DeleteSerialnumber() {
        try {
		this.serialnumberDao
				.Delete(this.serialnumber.getFuniqueid());

		this.message = "成功删除";
        } catch (RuntimeException ex) {
			this.message = ex.getMessage();
			this.errcode = ex.hashCode();
		}	
        
		dataMap = new HashMap<String, Object>();
		dataMap.put("id", this.serialnumber.getFuniqueid());
		dataMap.put("errcode", this.errcode);
        dataMap.put("success", true);
		dataMap.put("message", this.message);

		return SUCCESS;
	}
    
	public String List() {		 
	    return SUCCESS;
	}
}